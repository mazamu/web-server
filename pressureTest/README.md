# 测试机环境（运行服务器代码的机器）

- 阿里云服务器ECS
- CPU&内存 : 2核 2 GiB
- Ubuntu  16.04 64位

# 测试工具
- webbench

# 运行测试工具webbench的机器
- OS: Unbuntu 16.04(32位) (虚拟机，宿主机为Win10)

- 宿主机硬件:
  - CPU: i7-8565U
  - 内存: 8GB
- 虚拟机分配资源
  - CPU资源: 2核
  - 内存: 2GB

# 压力测试

原本我的代码有问题，只支持100多个并发量，再多服务器就崩溃了，一直在找原因（注释了定时器部分代码、使用了游双附带的服务器代码里面的日志系统）....
今天找到原因：在使用多线程时，回收子线程时使用了detach(),改为了join()后正常了，两者区别这里不多阐述。

下面是还没未使用定时器时，使用webbench来测试的结果，
![1](https://images.gitee.com/uploads/images/2021/1015/113248_8bd2f495_7524349.png "033aec26224325221f2e217951d8c4c.png")

当测试时间较长时，会有部分数据发送失败：

![2](https://images.gitee.com/uploads/images/2021/1015/113930_132eec7b_7524349.png "308362103c45f5423841bd447229d71.png")

我猜测的原因是：没有定时器，服务器很多端口处于TIME_WAIT状态，这些状态不及时处理，导致服务器资源不足，建立连接失败导致的发送失败

![输入图片说明](https://images.gitee.com/uploads/images/2021/1015/114130_a3d40c35_7524349.png "1634269227(1).png")

等待更新定时器代码后的压力测试，
